<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DNI CO â€“ Ø¨Ø®Ø´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ùˆ Ø§Ù…Ù†ÛŒØª</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #0e1117;
      color: #e6e6e6;
      min-height: 100vh;
    }
    
    /* Ù†ÙˆØ§Ø± Ù‡Ø´Ø¯Ø§Ø± */
    .alert-bar {
      background: linear-gradient(90deg, #ff4444, #ff6b6b);
      color: white;
      text-align: center;
      padding: 12px;
      font-size: 14px;
      animation: slideDown 0.5s ease;
      display: none;
      position: relative;
      overflow: hidden;
    }
    
    .alert-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      animation: shimmer 2s infinite;
    }
    
    header {
      text-align: center;
      padding: 40px 20px;
      animation: fadeIn 1s ease;
      position: relative;
    }
    
    .user-info {
      position: absolute;
      left: 20px;
      top: 20px;
      background: rgba(26, 31, 39, 0.8);
      padding: 8px 15px;
      border-radius: 8px;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .logout-btn {
      background: #ff4444;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 12px;
      transition: 0.3s;
    }
    
    .logout-btn:hover {
      background: #cc0000;
    }
    
    h1 {
      margin: 0;
      font-size: 36px;
      letter-spacing: 2px;
    }
    
    h2 {
      margin-top: 10px;
      font-size: 18px;
      font-weight: 300;
      opacity: 0.8;
    }
    
    /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø¬Ø³ØªØ¬Ùˆ */
    .search-container {
      width: 90%;
      max-width: 400px;
      margin: 30px auto;
      position: relative;
      animation: slideDown 0.8s ease;
    }
    
    #searchBox {
      width: 100%;
      padding: 12px 45px 12px 15px;
      border-radius: 10px;
      border: 2px solid #1a1f27;
      font-size: 16px;
      outline: none;
      background: #1a1f27;
      color: #fff;
      transition: all 0.3s;
    }
    
    #searchBox:focus {
      border-color: #2864ff;
      box-shadow: 0 0 0 3px rgba(40, 100, 255, 0.1);
    }
    
    .search-icon {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #6c757d;
      font-size: 18px;
    }
    
    /* Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØ¹Ø¯Ø§Ø¯ */
    .count-info {
      text-align: center;
      margin-bottom: 20px;
      font-size: 14px;
      opacity: 0.8;
      animation: fadeIn 0.6s ease;
    }
    
    #list {
      width: 95%;
      max-width: 700px;
      margin: auto;
      padding-bottom: 80px;
      animation: fadeIn 0.6s ease;
    }
    
    .item {
      background: linear-gradient(135deg, #1a1f27, #232834);
      padding: 18px 25px;
      border-radius: 12px;
      margin-bottom: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s;
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .item:hover {
      transform: translateY(-5px);
      border-color: rgba(40, 100, 255, 0.3);
      box-shadow: 0 8px 15px rgba(0,0,0,0.2);
    }
    
    .item-info {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }
    
    .item-id {
      font-size: 12px;
      opacity: 0.6;
      font-family: monospace;
    }
    
    .item-name {
      font-size: 16px;
    }
    
    .btn {
      padding: 10px 20px;
      background: linear-gradient(135deg, #2864ff, #1e4ed8);
      border-radius: 8px;
      color: #fff;
      text-decoration: none;
      font-size: 14px;
      transition: all 0.3s;
      border: none;
      cursor: pointer;
      white-space: nowrap;
    }
    
    .btn:hover {
      background: linear-gradient(135deg, #1e4ed8, #1542b8);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(40, 100, 255, 0.3);
    }
    
    /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ ÙˆÙ‚ØªÛŒ Ù†ØªÛŒØ¬Ù‡â€ŒØ§ÛŒ Ù†ÛŒØ³Øª */
    .no-results {
      text-align: center;
      padding: 40px;
      opacity: 0.6;
      animation: fadeIn 0.6s ease;
    }
    
    footer {
      text-align: center;
      padding: 20px;
      opacity: 0.6;
      font-size: 14px;
      border-top: 1px solid rgba(255,255,255,0.1);
      margin-top: 40px;
    }
    
    /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slideDown {
      from { transform: translateY(-20px); opacity:0; }
      to { transform: translateY(0); opacity:1; }
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    /* Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ */
    @media (max-width: 768px) {
      .item {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .user-info {
        position: static;
        margin-bottom: 15px;
        justify-content: center;
      }
      
      header {
        padding-top: 20px;
      }
      
      h1 {
        font-size: 28px;
      }
      
      h2 {
        font-size: 16px;
      }
    }
    
    @media (max-width: 480px) {
      .search-container {
        width: 95%;
      }
      
      .item {
        padding: 15px;
      }
      
      .btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- Ù†ÙˆØ§Ø± Ù‡Ø´Ø¯Ø§Ø± Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ ØºÛŒØ±Ù…Ø¬Ø§Ø² -->
  <div class="alert-bar" id="alertBar">
    <strong>âš  Ù‡Ø´Ø¯Ø§Ø± Ø§Ù…Ù†ÛŒØªÛŒ:</strong> Ø¯Ø³ØªØ±Ø³ÛŒ ØºÛŒØ±Ù…Ø¬Ø§Ø² Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯! Ø¯Ø± Ø­Ø§Ù„ Ù‡Ø¯Ø§ÛŒØª Ø¨Ù‡ ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯...
  </div>

  <header>
    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± -->
    <div class="user-info" id="userInfo">
      <span id="userName"></span>
      <button class="logout-btn" onclick="logout()">Ø®Ø±ÙˆØ¬</button>
    </div>
    
    <h1>DNI CO</h1>
    <h2>Ø¨Ø®Ø´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ùˆ Ø§Ù…Ù†ÛŒØª</h2>
  </header>

  <!-- Ø¬Ø³ØªØ¬Ùˆ -->
  <div class="search-container">
    <input type="text" id="searchBox" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ù¾Ø±ÙˆÙ†Ø¯Ù‡â€ŒÙ‡Ø§ (Ù†Ø§Ù… ÛŒØ§ Ø´Ù…Ø§Ø±Ù‡ Ù¾Ø±ÙˆÙ†Ø¯Ù‡)..." />
    <div class="search-icon">ğŸ”</div>
  </div>
  
  <!-- ØªØ¹Ø¯Ø§Ø¯ Ù†ØªØ§ÛŒØ¬ -->
  <div class="count-info" id="countInfo"></div>

  <!-- Ù„ÛŒØ³Øª Ù¾Ø±ÙˆÙ†Ø¯Ù‡â€ŒÙ‡Ø§ -->
  <div id="list">
    <div class="no-results" id="noResults" style="display: none;">
      Ù¾Ø±ÙˆÙ†Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø§ Ù…Ø´Ø®ØµØ§Øª Ø¬Ø³ØªØ¬Ùˆ Ø´Ø¯Ù‡ ÛŒØ§ÙØª Ù†Ø´Ø¯.
    </div>
  </div>

  <footer>ØªÙ…Ø§Ù…ÛŒ Ø­Ù‚ÙˆÙ‚ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ DNI CO</footer>

  <script>
    // Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯ÛŒÙ† Ù‡Ù†Ú¯Ø§Ù… Ù„ÙˆØ¯ ØµÙØ­Ù‡
    window.addEventListener('DOMContentLoaded', () => {
      const loggedInUser = localStorage.getItem('dniLoggedInUser');
      const alertBar = document.getElementById('alertBar');
      
      if (!loggedInUser) {
        // Ù†Ù…Ø§ÛŒØ´ Ù‡Ø´Ø¯Ø§Ø± Ø§Ù…Ù†ÛŒØªÛŒ
        alertBar.style.display = 'block';
        
        // Ù‡Ø¯Ø§ÛŒØª Ø¨Ù‡ ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯ Ø¨Ø¹Ø¯ Ø§Ø² 3 Ø«Ø§Ù†ÛŒÙ‡
        setTimeout(() => {
          window.location.href = "index.html";
        }, 3000);
        
        // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø¯Ø§Ù…Ù‡ Ù„ÙˆØ¯ ØµÙØ­Ù‡
        document.body.style.display = 'none';
      } else {
        // Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±
        try {
          const user = JSON.parse(loggedInUser);
          document.getElementById('userName').textContent = user.name;
        } catch (e) {
          localStorage.removeItem('dniLoggedInUser');
          window.location.href = "index.html";
        }
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾Ø±ÙˆÙ†Ø¯Ù‡â€ŒÙ‡Ø§
        loadDocs();
      }
    });
    
    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾Ø±ÙˆÙ†Ø¯Ù‡â€ŒÙ‡Ø§
    async function loadDocs() {
      try {
        const res = await fetch("doc.json");
        const data = await res.json();
        render(data, "");
        
        // ØªÙ†Ø¸ÛŒÙ… Ø¬Ø³ØªØ¬Ùˆ
        document.getElementById("searchBox").addEventListener("input", e => {
          render(data, e.target.value);
        });
      } catch (error) {
        console.error("Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾Ø±ÙˆÙ†Ø¯Ù‡â€ŒÙ‡Ø§:", error);
        document.getElementById("list").innerHTML = 
          '<div class="no-results">Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾Ø±ÙˆÙ†Ø¯Ù‡â€ŒÙ‡Ø§</div>';
      }
    }
    
    // Ø±Ù†Ø¯Ø± Ù„ÛŒØ³Øª
    function render(docs, search="") {
      const list = document.getElementById("list");
      const countInfo = document.getElementById("countInfo");
      const noResults = document.getElementById("noResults");
      
      // ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† (Ù‡Ù… Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ø§Ù… Ùˆ Ù‡Ù… ID)
      const filtered = docs.filter(d => 
        d.name.toLowerCase().includes(search.toLowerCase()) || 
        d.id.toString().includes(search)
      );
      
      // Ù†Ù…Ø§ÛŒØ´ ØªØ¹Ø¯Ø§Ø¯ Ù†ØªØ§ÛŒØ¬
      countInfo.textContent = `${filtered.length} Ù¾Ø±ÙˆÙ†Ø¯Ù‡ ÛŒØ§ÙØª Ø´Ø¯`;
      
      if (filtered.length === 0) {
        noResults.style.display = "block";
        list.innerHTML = "";
        return;
      }
      
      noResults.style.display = "none";
      
      // Ø³Ø§Ø®Øª Ù„ÛŒØ³Øª
      let html = "";
      filtered.forEach(doc => {
        html += `
          <div class="item">
            <div class="item-info">
              <div class="item-id">Ù¾Ø±ÙˆÙ†Ø¯Ù‡ Ø´Ù…Ø§Ø±Ù‡: ${doc.id}</div>
              <div class="item-name">${doc.name}</div>
            </div>
            <a class="btn" href="doc/${doc.file}" download>
              ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯
            </a>
          </div>
        `;
      });
      
      list.innerHTML = html;
    }
    
    // ØªØ§Ø¨Ø¹ Ø®Ø±ÙˆØ¬
    function logout() {
      if (confirm("Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø®Ø§Ø±Ø¬ Ø´ÙˆÛŒØ¯ØŸ")) {
        localStorage.removeItem('dniLoggedInUser');
        window.location.href = "index.html";
      }
    }
    
    // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø­Ø§ÙØ¸Ù‡ Ù…ÙˆÙ‚Øª
    window.addEventListener('beforeunload', () => {
      // Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¹Ù…Ù„ÛŒØ§Øª Ø®Ø§ØµÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯
    });
    
    // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² back button
    history.pushState(null, null, location.href);
    window.onpopstate = function () {
      history.go(1);
    };
  </script>
</body>
</html>
